{"version":3,"file":"scroll-to-view.js","sources":["../src/index.js"],"sourcesContent":["/*\n * @Author: 卓文理\n * @Email: zhuowenligg@gmail.com\n * @Date: 2019-08-17 12:24:33\n */\n\nconst fxEase = t => (((t *= 2) < 1) ? (0.5 * t * t) : (0.5 * (1 - (--t) * (t - 2))));\nconst setTop = top => window.scrollTo(0, top);\n\n/**\n * scrollToView\n *\n * @export\n * @param {string} selector element selector\n * @param {number} [duration=300] animate time\n * @param {function} callback\n */\nexport default function scrollToView(selector, duration = 300, callback) {\n    if (typeof selector === 'number' || selector === 'auto') {\n        callback = duration;\n        duration = selector;\n        selector = null;\n    }\n\n    let top = 0;\n    let fxTimer = null;\n    const currTop = window.scrollY;\n\n    if (selector) {\n        const elem = document.body.querySelector(selector);\n\n        if (!elem) {\n            throw new Error(`Failed to execute 'querySelector' on 'Element': '${selector}' is not a valid selector.`)\n        }\n\n        top = currTop + elem.getBoundingClientRect().top;\n    }\n\n    const baseOffset = 400;\n    const maxDuration = 400;\n    const tMark = new Date();\n    const heightOffset = top - currTop;\n\n    if (duration === 'auto') {\n        duration = baseOffset * Math.abs(heightOffset / baseOffset);\n        duration = Math.max(0, Math.min(maxDuration, duration));\n    } else if (typeof duration !== 'number') {\n        duration = 0;\n    }\n\n    return new Promise(resolve => {\n        function fx() {\n            const elapsed = new Date() - tMark;\n\n            if (elapsed >= duration) {\n                setTop(top);\n\n                if (callback) {\n                    return callback();\n                }\n\n                return resolve();\n            }\n\n            setTop(currTop + heightOffset * fxEase(elapsed / duration));\n            fxTimer = setTimeout(fx, 16);\n        }\n\n        clearTimeout(fxTimer);\n\n        fxTimer = setTimeout(fx, 16);\n    });\n}"],"names":["fxEase","t","setTop","top","window","scrollTo","scrollToView","selector","duration","callback","fxTimer","currTop","scrollY","elem","document","body","querySelector","Error","getBoundingClientRect","baseOffset","maxDuration","tMark","Date","heightOffset","Math","abs","max","min","Promise","resolve","fx","elapsed","setTimeout","clearTimeout"],"mappings":";;;;;;IAAA;;;;;IAMA,IAAMA,MAAM,GAAG,SAATA,MAAS,CAAAC,CAAC;IAAA,SAAM,CAACA,CAAC,IAAI,CAAN,IAAW,CAAZ,GAAkB,MAAMA,CAAN,GAAUA,CAA5B,GAAkC,OAAO,IAAK,EAAEA,CAAH,IAASA,CAAC,GAAG,CAAb,CAAX,CAAvC;IAAA,CAAhB;;IACA,IAAMC,MAAM,GAAG,SAATA,MAAS,CAAAC,GAAG;IAAA,SAAIC,MAAM,CAACC,QAAP,CAAgB,CAAhB,EAAmBF,GAAnB,CAAJ;IAAA,CAAlB;IAEA;;;;;;;;;;AAQA,IAAe,SAASG,YAAT,CAAsBC,QAAtB,EAA0D;IAAA,MAA1BC,QAA0B,uEAAf,GAAe;IAAA,MAAVC,QAAU;;IACrE,MAAI,OAAOF,QAAP,KAAoB,QAApB,IAAgCA,QAAQ,KAAK,MAAjD,EAAyD;IACrDE,IAAAA,QAAQ,GAAGD,QAAX;IACAA,IAAAA,QAAQ,GAAGD,QAAX;IACAA,IAAAA,QAAQ,GAAG,IAAX;IACH;;IAED,MAAIJ,GAAG,GAAG,CAAV;IACA,MAAIO,OAAO,GAAG,IAAd;IACA,MAAMC,OAAO,GAAGP,MAAM,CAACQ,OAAvB;;IAEA,MAAIL,QAAJ,EAAc;IACV,QAAMM,IAAI,GAAGC,QAAQ,CAACC,IAAT,CAAcC,aAAd,CAA4BT,QAA5B,CAAb;;IAEA,QAAI,CAACM,IAAL,EAAW;IACP,YAAM,IAAII,KAAJ,4DAA8DV,QAA9D,gCAAN;IACH;;IAEDJ,IAAAA,GAAG,GAAGQ,OAAO,GAAGE,IAAI,CAACK,qBAAL,GAA6Bf,GAA7C;IACH;;IAED,MAAMgB,UAAU,GAAG,GAAnB;IACA,MAAMC,WAAW,GAAG,GAApB;IACA,MAAMC,KAAK,GAAG,IAAIC,IAAJ,EAAd;IACA,MAAMC,YAAY,GAAGpB,GAAG,GAAGQ,OAA3B;;IAEA,MAAIH,QAAQ,KAAK,MAAjB,EAAyB;IACrBA,IAAAA,QAAQ,GAAGW,UAAU,GAAGK,IAAI,CAACC,GAAL,CAASF,YAAY,GAAGJ,UAAxB,CAAxB;IACAX,IAAAA,QAAQ,GAAGgB,IAAI,CAACE,GAAL,CAAS,CAAT,EAAYF,IAAI,CAACG,GAAL,CAASP,WAAT,EAAsBZ,QAAtB,CAAZ,CAAX;IACH,GAHD,MAGO,IAAI,OAAOA,QAAP,KAAoB,QAAxB,EAAkC;IACrCA,IAAAA,QAAQ,GAAG,CAAX;IACH;;IAED,SAAO,IAAIoB,OAAJ,CAAY,UAAAC,OAAO,EAAI;IAC1B,aAASC,EAAT,GAAc;IACV,UAAMC,OAAO,GAAG,IAAIT,IAAJ,KAAaD,KAA7B;;IAEA,UAAIU,OAAO,IAAIvB,QAAf,EAAyB;IACrBN,QAAAA,MAAM,CAACC,GAAD,CAAN;;IAEA,YAAIM,QAAJ,EAAc;IACV,iBAAOA,QAAQ,EAAf;IACH;;IAED,eAAOoB,OAAO,EAAd;IACH;;IAED3B,MAAAA,MAAM,CAACS,OAAO,GAAGY,YAAY,GAAGvB,MAAM,CAAC+B,OAAO,GAAGvB,QAAX,CAAhC,CAAN;IACAE,MAAAA,OAAO,GAAGsB,UAAU,CAACF,EAAD,EAAK,EAAL,CAApB;IACH;;IAEDG,IAAAA,YAAY,CAACvB,OAAD,CAAZ;IAEAA,IAAAA,OAAO,GAAGsB,UAAU,CAACF,EAAD,EAAK,EAAL,CAApB;IACH,GArBM,CAAP;IAsBH;;;;;;;;"}